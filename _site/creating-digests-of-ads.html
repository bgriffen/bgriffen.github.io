<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	  <meta name="author" content="Brendan Griffen" />
    <meta name="description" content="A human exploring the very large and the very small.">
    <link rel="favicon" href="/static/img/favicon.ico">

    
      <title>Creating Digests Of The Astronomy Arxiv</title>
    
	
    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha256-MfvZlkHCEqatNoGiOXveE8FIwMzZg4W85qfrfIFBfYc= sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ=="
    crossorigin="anonymous">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

	<!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="/static/css/main.css" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="/static/css/syntax.css" />

    <!-- Google Analytics -->
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2011187-3', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <!-- Main Body-->
  <body>
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Navbar header -->
    <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="/"><i class="fa fa-home"></i></a>
    </div>
    <div id="navbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/blog.html">BLOG</a></li>
        <li><a href="/bio.html"">BIO</a></li>
        <li><a href="/scaledbiolabs.html">BIOTECH</a></li>
        <li><a href="/astrophysics.html">ASTROPHYSICS</a></li>
        
      </ul>
    </div>
  </div>
  <script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" id="st_insights_js" src="http://w.sharethis.com/button/buttons.js?publisher=4c4961d4-1888-423c-9cce-30a753eaf0e0"></script>
<script type="text/javascript">stLight.options({publisher: "4c4961d4-1888-423c-9cce-30a753eaf0e0", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

</nav>

    <div class="container">
	<div class="blog-post">
		<h3>
		  <strong><a href="/creating-digests-of-ads.html">Creating Digests Of The Astronomy Arxiv</a></strong>
		</h3>
	</div>
	<div class="blog-title">
		<h4>
		November  4, 2014
			&nbsp;&nbsp;
			
			 <span class="label label-success">python</span>
			
			 <span class="label label-success">astronomy</span>
			
			 <span class="label label-success">academia</span>
			
			 <span class="label label-success">ads</span>
			
		</h4>
	</div>
	<div class="panel panel-default">
		<div class="panel-body">
			<div class="blogpost">
			  <p>I took another look at <a href="https://github.com/andycasey/ads">ADS-python</a> (a python tool for ADS) developed by <a href="http://astrowizici.st/">Andy Casey</a>. I modified his example script to email myself a digest of all of the papers published by my institute in the past month. I set it up as an automated cron job (<code>10 0 1 * * python script.py</code>) to be run on the 1st of each month so I don&rsquo;t have to run the script anymore to get the digest. You will need <a href="https://github.com/alexandrevicenzi/fluentmail">FluentMail</a> for this to work. You will also need to allow Gmail to receive login requests from less familiar apps. If you want to use a different email client see <a href="https://github.com/alexandrevicenzi/fluentmail#common-smtp-servers">here</a>. I&rsquo;ve setup a <a href="http://www.github.com/bgriffen/ads.git">GitHub repository</a> for these codes and future codes relating to work done with ADS.</p>

<pre><code class="python"># Core libraries
from time import localtime
import sys,os
import subprocess as sub

# Module Libraries
import ads
from fluentmail import FluentMail

mail = FluentMail('smtp.gmail.com', 465, 'SSL')
email_address = 'brendan.f.griffen@gmail.com'
email_password = 'password'
output_directory = "./"
download_papers = False
my_affiliation = '"Kavli Institute For Astrophysics"'

if __name__ == "__main__":

    # Let's do it for *last* month
    current_time = localtime()

    # Last month
    year = current_time.tm_year - 1 if current_time.tm_mon == 1 else current_time.tm_year
    month = current_time.tm_mon - 1 if current_time.tm_mon &gt; 1 else 12

    # Get all the articles
    articles1 = ads.search(
        affiliation=my_affiliation,
        filter="database:astronomy AND property:refereed",
        dates="{year}/{month}".format(year=year, month=month))

    articles = list(articles1)
    print("There were {0} articles found for {year}/{month} with MKI co-authors.".format(len(articles),year=year, month=month))

    # Sort articles
    sorted_articles = sorted(articles,
        key=lambda article: [(my_affiliation.strip('"').lower() in affiliation.lower()) for affiliation in article.aff].index(True))

    # Option to download these papers
    if download_papers:
        output_folder = output_directory + "{year}_{month}".format(year=year,month=month)
        cmd_make_this_months_folder = "mkdir -p " + output_folder
        sub.call([cmd_make_this_months_folder],shell=True)

        filename = output_folder + "/" + article.bibcode + ".pdf"
        if not os.path.isfile(filename):
            ads.retrieve_article(article, output_filename=output_folder + "/" + article.bibcode + ".pdf")

    # Construct email content
    email_content = "There were {num} articles published by astronomy researchers from the {my_affiliation} last month ({year}/{month})"\
                    .format(num=len(articles),my_affiliation=my_affiliation,year=year,month=month)

    for article in sorted_articles:
        email_content += article.author[0].split(",")[0] + " et al.\n" +\
                         article.title[0] + "\n" + article.abstract + "\n" +\
                         article.url + "\n\n"

    # Email yourself the digest
    mail.credentials(email_address, email_password)\
    .from_address(email_address).to(email_address)\
    .subject('Monthly Institute Arxiv Digest')\
    .body(email_content)\
    .send()
</code></pre>

<p>Here is an example of what one of these emails might look like:</p>

<p><a href="/assets/adspython/monthly_arxiv_digest.png"><img src="/assets/adspython/monthly_arxiv_digest.png" alt="Digest" /></a></p>

<p>I usually read new papers through my RSS reader <a href="http://www.feedly.com">Feedly</a>, which has a feature which tells you roughly how many people have also bookmarked that paper (see the left side). I think this is a rough proxy for &lsquo;interest&rsquo; and I often take more notice of papers with a high number of bookmarks.</p>

<p><a href="/assets/adspython/feedly_popular_papers.png"><img src="/assets/adspython/feedly_popular_papers.png" alt="Most popular" /></a></p>

<p> I wanted a &lsquo;top 10 most popular&rsquo; list from the ADS listings from &lsquo;yesterday&rsquo; - whenever that may be. It is convenient to know what is making headlines in the community.</p>

<pre><code class="python"># Core libraries
from time import localtime
import numpy as np

# Module Libraries
import ads
from fluentmail import FluentMail

mail = FluentMail('smtp.gmail.com', 465, 'SSL')
email_address = 'brendan.f.griffen@gmail.com'
email_password = 'password'
email_content = ""

if __name__ == "__main__":
    current_time = localtime()
    year = current_time.tm_year
    month = current_time.tm_mon
    day = current_time.tm_mday-1 # yesterday

    # Get papers
    papers = list(ads.query(dates="{year}/{month}/{day}"\
            .format(year=year, month=month, day=day),filter="database:astronomy", rows=200))

    # Get number of reads
    num_reads_list = []
    for paper in papers:
        num_reads = paper.metrics['all_reads']['Total_number_of_reads']
        num_reads_list.append(num_reads)

    idx_num_reads = np.argsort(np.array(num_reads_list))[::-1]

    # Construct email content
    email_content = "Top viewed papers for {day}/{month}/{year}\n\n"\
                    .format(year=year, month=month, day=day)

    for idx,i in enumerate(idx_num_reads[:10]):
        email_content += str(idx+1) + ". " + \
        papers[i].author[0].split(",")[0] + " et al. &gt; # reads: " + \
        str(papers[i].metrics['all_reads']['Total_number_of_reads']) + "\n" + \
        papers[i].title[0] + "\n" + \
        papers[i].abstract + "\n" + \
        papers[i].url + "\n\n"

    print email_content
    # Email content
    mail.credentials(email_address, email_password)\
    .from_address(email_address)\
    .to(email_address)\
    .subject("Yesterday's most popular papers!")\
    .body(email_content)\
    .send()
</code></pre>

<p>Here is an example of what one of these emails might look like:</p>

<p><a href="/assets/adspython/yesterdays_most_popular.png"><img src="/assets/adspython/yesterdays_most_popular.png" alt="Most popular" /></a></p>

<p>This is really only the beginning of the sort of thing you can do with nice Python-esk access to the ADS database.</p>

			  <hr>
			  <center>To be notified of future posts, please <a href="https://feeds.feedburner.com/brendangriffen"><i class="fa fa-fw fa-rss-square"></i>click here</a>.</center>
			  <div class="socialsmall">
	<h4>
        <center>
    
      <a href="mailto:brendan.f.griffen@gmail.com"><i class="fa fa-envelope"></i></a>
    

    
	  <a href="http://github.com/bgriffen"><i class="fa fa-github"></i></a>
    
    
    
	  <a href="http://twitter.com/brendangriffen"><i class="fa fa-twitter"></i></a>
    
    
	  <a href="http://linkedin.com/in/brendangriffen"><i class="fa fa-linkedin"></i></a>
    
    
	  <a href="http://stackoverflow.com/users/1495869/griff"><i class="fa fa-stack-overflow"></i></a>
    
    
    <a href="https://feeds.feedburner.com/brendangriffen"><i class="fa fa-rss-square"></i></a>
    
    </center>
	</h4>
</div>


			   <div class="related-posts">
			   <hr>
				   <h5>Related Posts</h5>
				   
						<div class="row">
							 <div class="col-sm-4 col-md-4 col-lg-4">
								 <h6 style="text-align: right">
								 	June 11, 2016
								 </h6>
							 </div>
							 <div class="col-sm-8 col-md-8 col-lg-8">
								 <h6 style="text-align: left">
								 	<strong><a href="//goodbye-astronomy-for-now.html">Goodbye Astronomy, Part 1: How I got here</a></strong>
								 </h6>
							 </div>
						</div>
					
						<div class="row">
							 <div class="col-sm-4 col-md-4 col-lg-4">
								 <h6 style="text-align: right">
								 	April  4, 2016
								 </h6>
							 </div>
							 <div class="col-sm-8 col-md-8 col-lg-8">
								 <h6 style="text-align: left">
								 	<strong><a href="//analysis-of-hubble-einstein-sagan-fellowship-holders-with-ads.html">Hubble, Einstein and Sagan Fellows With ADS</a></strong>
								 </h6>
							 </div>
						</div>
					
						<div class="row">
							 <div class="col-sm-4 col-md-4 col-lg-4">
								 <h6 style="text-align: right">
								 	March  6, 2016
								 </h6>
							 </div>
							 <div class="col-sm-8 col-md-8 col-lg-8">
								 <h6 style="text-align: left">
								 	<strong><a href="//mapping-astronomy-publications.html">Mapping Astronomy Publications</a></strong>
								 </h6>
							 </div>
						</div>
					
			   </div>
			</div>
		</div>
	</div>
	
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//brendangriffen.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                


</div>


  </div>
  <!-- Footer -->

  <footer>
    <div id="footer">
        <div class="container">
            <p class="text-muted">© Brendan Griffen 2016. Powered by <a href="http://jekyllrb.com/">Jekyll.</p>
        </div>
    </div>
</footer>
<div class="footer"></div>

  

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"
    integrity="sha256-Sk3nkD6mLTMOF0EOpNtsIry+s1CsaqQC1rVLTAy+0yc= sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ=="
    crossorigin="anonymous"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="/static/js/docs.min.js"></script>
    <script src="/static/js/main.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/static/js/ie10-viewport-bug-workaround.js"></script>

    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>


  </body>
</html>
